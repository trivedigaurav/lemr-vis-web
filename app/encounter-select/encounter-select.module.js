'use strict';

(function(angular){

  var _template =  'encounter-select/encounter-select.template.html';

  var app = angular.module('encounter.select', []);
  
  app.component('encounterSelect',{
      
      restrict: 'E',
      bindings: {
        load: '&',
      },
      templateUrl: _template,
      controller: SelectController,
      controllerAs: 'esel'
    });
  
  
  function SelectController(){
    var self = this;
    
    self.$onInit = function(){
      //Control
      self.enc_286_control = [228814218,230972014,231034164,229806114,229495357,226476355,230952022,226832436,231383429,233223298,232210069,229416301,227314542,226164960,230430895,231400199,233351256,225592854,231026159,232170874,233036582,228139309,226257042,233018710,228802689,228969072,233389784,232694238,232574841,233714017,225486615,231395961,225624012,230999197,230191154,227474602,228148522,231369662,231699095,228809036,224915154,226296038,228663854,227008288,230252942,226576221,227180446,227309143,231438810,232223243,226144792,229473577,233021182,226139301,225376113,233648924,225474064,229223074,232374931,226494054,228246406,231697727,225483021,225147613,225769930,229748260,228618502,227997393,233129796,228768121,231507623,226392634,226077872,229308211,229043732,230672693,233875745,224745236,232157929,225400649,225282762,230130769,227257509,230997588,230997037,231414050,228409039,230223895,226143029,233877631,230139266,232108167,232502556,233042520,231421626,228826547,226190835,227450929,227500151,229307760,226812953,229720058,228374874,232329895,231412494,225802543,231129240,233524917,230883670,227470058,228522074,227454911,232194702,229888004,226812581,226103736,223498461,228827722,232996696,228880211,228810828,226831796,230154085,229479212,232723426,231433472,232522788,231541722,232548956,231239445,233200332,232017140,229233959,226751451,225596778,228126682,229326837,228054458,225293948,232033345,226808644,224722991,232889624,229351670,233045543,232170901,233349732,228783677,225859079,227990307,232229609,230869788,230858474,225475596,225154980,229455872,226224230,233260163,229215584,230996934,226134775,225704748,231420467,228812783,224942709,233048089,226097532,226151971,232061586,230802905,231438928,228017848,226017646,225864893,229852817,228800714,229430597,230872258,225185820,226770705,227425030,233391230,225735723,231128383,226375310,224935578,226649776,227856278,229847669,226261158,228812043,228144422,232137006,228164507,231033356,232399268,229615983,229162388,233037770,231004347,231121974,231434167,231407791,231697597,230881914,230854382,226635404,228565268,230873418,224421013,225438241,232307370,226944079,228241257,231528616,227003003,231847443,229100524,226810731,231656104,225481446,229479408,230885153,231087316,230286061,229472010,228932343,227473129,228920308,231504498,229465834,228756260,225757760,229831971,229433488,229479175,228967673,229419939,231424365,224853059,228091521,230867866,230136242,226621165,230148191,230783521,231414526,232399262,229068333,228144190,229257613,228530677,225501649,229458015,232861542,230504342,233864682,228126322,230854953,231434249,226142635,229434009,226391949,225906519,227471974,224520146,228839235,230939149,227083969,225443044,226942755,225759549,225437898,228910920,233041034,228518350,229426407,227901781,228104263,230149792,226951061,225634393,226139164,230481713,229073141,225156580];

      let stored = localStorage.getItem('activeEncounter');

      if (self.enc_286_control.indexOf(stored) != -1)
        self.eid = stored;
      else{
        self.eid = "228814218";
        localStorage.setItem('activeEncounter', self.eid);
      }
    }

    self.selectEncounter = function(){
      // console.log("changeEncounter", self.eid);
      if(self.eid == null)
        return

      localStorage.setItem('activeEncounter', self.eid);
      self.load({encounter: self.eid});
    }
    
  }
  
})(window.angular);