<!DOCTYPE html>
<html lang="en" ng-app="myApp">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>LEMR NLP Web</title>

  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="../node_modules/html5-boilerplate/css/normalize.css">
  <link rel="stylesheet" href="../node_modules/html5-boilerplate/css/main.css">
  <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="../node_modules/animate.css/animate.min.css">
  <link rel="stylesheet" href="css/app.css"/>
  <link rel="stylesheet" href="css/annotator.min.css"/>
  <link rel="stylesheet" href="css/annotator-categories.css"/>
  <link rel="stylesheet" href="css/login.css"/>

  <link rel="icon" href="favicon.png">
  
  <style type="text/css">
    /**
     * Hide when Angular is not yet loaded and initialized
     */
    [ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
      display: none !important;
    }
  </style>

</head>

<body class="ng-cloak" ng-controller="appCtrl" ui-keypress="{'right':'keypressCallback($event, false)', 'left':'keypressCallback($event, true)'}">
  <canvas id="map"></canvas>

<!-- <div ng-show="appDisabled" class="coverall"></div> -->

  <div ng-if="!active.username" class="coverall" id="login">
    <!-- TODO: Proper login -->
    <login user="active.username" load="loadEncounter()"></login>
  </div>
  
  <div ng-show="loaderCount > 0" id="appLoading" class="alert alert-warning appNotice">
    <strong>Loading!</strong> Please wait.
  </div>

  <header class="navbar navbar-inverse navbar-fixed-top">
    <nav class="hidden-xs">
      <ul class="nav navbar-nav" id="main-menu">
        <span role="button" class="navbar-brand">
          <img alt="Brand" src="favicon.png">&nbsp;
          <small>Patient #</small>{{active.encounterId}}

          <span ng-if="active.encounterData">
            <small>Admit:</small> {{active.encounterData.admit | myDate}}          
            <small>Discharge:</small> {{active.encounterData.discharge | myDate}}
          </span>
        </span>
      </ul>

      <ul class="nav navbar-nav navbar-right">
        <li>
          <a ng-click="doLogout()" ng-disabled="loaderCount != 0"><i class="glyphicon glyphicon-log-out ng-scope"></i> Logout &nbsp;</a>
        </li>
      </ul>

    </nav>
  </header>

<!-- Main container starts here. -->

    <div class="container-fluid">

    <div class="row">

      <!-- sidebar -->
      <div class="column col-xs-3" id="sidebar">

          <div id="encounter-display" class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title">Select encounter</h3>
            </div>
            <div class="panel-body">
              <encounter-select load="loadEncounter()" active="active.encounterId"></encounter-select>
            </div>
          </div>

<!--           <div id="lemr-suggest" class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title">LEMR Suggestions</h3>
            </div>
            <div class="panel-body">
              <div class="card-block">
                  <div class="list-group">
                    <a class="list-group-item active" href="javascript:;">
                        <p class="list-group-item-text">Donec id elit non mi porta gravida at eget metus. <big><b>List group heading.</b></big> Maecenas sed diam eget risus varius blandit.</p>
                    </a>
                    <a class="list-group-item" href="javascript:;">
                        <p class="list-group-item-text">Donec id elit non mi porta gravida at eget metus. <big><b>List group heading.</b></big> Maecenas sed diam eget risus varius blandit.</p>
                    </a>
                    <a class="list-group-item" href="javascript:;">
                        <p class="list-group-item-text">Donec id elit non mi porta gravida at eget metus. <big><b>List group heading.</b></big> Maecenas sed diam eget risus varius blandit.</p>
                    </a>
                  </div>
              
                  <a class="btn btn-default btn-block" href="#">View Signout Note</a>
              </div>
            </div>
          </div> -->

<!--           <div id="signout-display" class="panel panel-default" ng-if="active.encounterData">
            <div class="panel-heading">
              <h3 class="panel-title">Incidental Finding</h3>
            </div>
            <div class="panel-body">
              {{active.encounterData.incidental}}
            </div>
          </div> -->

          <div id="search-terms" class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title">Search Terms
              <span class="pull-right clickable" ng-click="isNavCollapsed = !isNavCollapsed">
                <span class="glyphicon glyphicon-chevron-up" ng-if="!isNavCollapsed"></span>
                <span class="glyphicon glyphicon-chevron-down" ng-if="isNavCollapsed"></span>
              </span>
              </h3>
            </div>
            <div class="panel-body" ng-if="!isNavCollapsed">
              <!-- Highlights input -->
              <form ng-submit="addTag(insertTag)">
                <div class="input-group">
                  <input type="text" 
                         class="form-control" 
                         id="exampleInputName2" 
                         placeholder="Add term..."
                         ng-model="insertTag">
                  <span class="input-group-btn">
                    <button type="submit" class="btn btn-default" ng-click="addTag(insertTag)">Add</button>
                  </span>
                </div>
              </form>
              <ul class="list-inline" >
                <li class="listItem" ng-repeat="elem in search_list">
                  <search-tag text="{{elem}}" close="closeTag(text)"></search-tag>
                </li>
              </ul>
            </div>
          </div>

      </div>

      <!-- Document views -->
      <div class="main" class="column col-xs-9">
        <!-- <div id="doc-navigator">
          <a tooltip-placement="bottom" tooltip-animation="false" tooltip="Previous" href="#prev" class="glyphicon glyphicon-chevron-left" ng-click="gotoNextDoc(true)"></a>
          <a tooltip-placement="bottom" tooltip-animation="false" tooltip="Next" href="#next" class="glyphicon glyphicon-chevron-right" ng-click="gotoNextDoc()"></a>
        </div> -->
        
        <!-- Feedback -->
  
        <tabset>

          <!-- Report view -->
          <tab active="tabs.docView" heading="Report">
            <div class="tab-inner-content" ng-if="active.encounterData.reports">

              <div class="pagerview">
                <div class="pagerview-row">
                    <div ng-repeat="report in active.encounterData.reports track by $index" class="pagerview-step">
                        <button type="button" scroll-to-bookmark='{{report.id}}' class="btn btn-default btn-circle">{{$index + 1}}</button>
                        <p class="clickable" scroll-to-bookmark='{{report.id}}'> {{report.date | myDate}} </p>
                    </div>
                </div>
              </div>
              
              <div ng-repeat="report in active.encounterData.reports track by $index" id="emr-report-{{report.id}}" class="report" ng-mouseup="expandSelectionText()">
                <div class="info unselectable" scroll-bookmark='{{report.id}}'>
                  <i class="glyphicon glyphicon-list-alt"></i>&nbsp;
                  <a tooltip-placement="bottom" tooltip-animation="false" tooltip='{{report.id}}'>
                    <strong class="file-name js-selectable-text">{{ report.date | myDate }}</strong>
                  </a>
                  
                  <a class="btn btn-xs btn-default pull-right" ng-click="popReport(report.id)" href="#{{report.id}}"><i class="glyphicon glyphicon-new-window"></i></a>

                  <span class="pull-right" ng-include src="'partials/report-paginate.html?v=' + cacheBust"></span>

                </div>
                <pre>
                    <highlighted-report data='report.text' record-id='report.id' helper-terms="search_list" >
                    <!-- redraw-map='pagemapCtrl.redraw'> -->
                   </highlighted-report>
                </pre>
              </div>
            </div>
          </tab>

          <!-- Retrain view -->
          <tab>
            <tab-heading>
              <i class="glyphicon glyphicon-refresh"></i> Re-Train &nbsp;<span ng-if="feedbackList.length > 0" class="badge alert-info pull-right animated bounceIn"> {{feedbackList.length}} </span>
            </tab-heading>
            <div class="tab-inner-content">

              <h4>Feedback List</h4>
              <div id="feedbackList">
                <p ng-hide="feedbackList.length">Feedback list is empty.</p>
                
                <div class="form-horizontal" ng-show="feedbackList.length">
                  <button class="btn btn-default"
                          on-confirm-click="clearFeedback()" confirm-click="Do you wish to clear all feedback?">
                    <i class="glyphicon glyphicon-trash"> </i> Clear All
                  </button>
                  <button class="btn btn-primary" 
                          ng-click="confirmFeedback(false)" >
                          <i class="glyphicon glyphicon-refresh"> </i> Re-Train
                  </button>
                </div>
              </div>

            </div>
          </tab>
        </tabset>

      </div>

    </div>
  </div>

  <script src="../node_modules/jquery/dist/jquery.min.js"></script>
  <script src="../node_modules/d3/d3.min.js"></script>
  <script src="../node_modules/jquery.scrollTo/jquery.scrollTo.min.js"></script>
  <script src="../node_modules/pagemap/dist/pagemap.min.js"></script>

  <script src="js/annotator-full.min.js"></script>
  <script src="js/annotator-categories.js"></script>
  <script src="js/report-highlight.js"></script>
  <script src="js/jquery-routines.js"></script>

  <script src="../node_modules/angular/angular.js"></script>
  <script src="../node_modules/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
  <script src="../node_modules/angular-cookies/angular-cookies.min.js"></script>

  <script src="../node_modules/rangy-official/rangy-core.min.js"></script>
  <script src="../node_modules/rangy-official/rangy-textrange.min.js"></script>
  <!-- <script src="../node_modules/rangy-official/rangy-classapplier.min.js"></script> -->


  <script src="../node_modules/angular-ui-utils/keypress.min.js"></script>
  
  <script src="js/app.js"></script>
  <script src="js/services.js"></script>
  <script src="js/controllers.js"></script>
  <script src="js/filters.js"></script>
  <script src="js/directives.js"></script>
  <script src="js/search.tags.module.js"></script>
  <script src="js/encounter.select.module.js"></script>
  <script src="js/login.module.js"></script>
  <!-- <script src="js/highlighted.report.directive.js"></script> -->
  
  <!-- <script src="../node_modules/angular-annotator/src/angular-annotator.js"></script> -->
  <!-- <script src="../node_modules/annotator-validation-plugin/src/annotator-validation-plugin.js"></script> -->
</body>
</html>
  
